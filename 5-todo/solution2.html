<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Todo - Solution 1</title>
  </head>
  <body>
    <p><em>A more robust solution for a todo list app.</em></p>
    <h1>// TODO</h1>
    <ul id="list"></ul>
    <input type="text" id="new-item" placeholder="Do a thing"/>
    <button type="button" id="insert-item">Insert</button>
    <script>
    // References to DOM elements
    var list = document.getElementById('list');
    var newItem = document.getElementById('new-item');
    var insertButton = document.getElementById('insert-item');

    // Use an array to keep track of todo items
    var todos = [
      'Learn JavaScript',
      'Make a todo list app',
      '???',
      'Profit!'
    ];

    // Remove a todo from the list
    function removeTodo(value) {
      // Get the index of the item in the array
      var index = todos.indexOf(value);
      // If present, remove the item from the array and re-render
      if (index > -1) {
        todos.splice(index, 1);
        makeList();
      }
    }

    // Add a todo item to the list
    function makeTodo(value) {
      // Create the list item
      var item = document.createElement('li');
      item.appendChild(document.createTextNode(value + ' '));
      // Create the delete button
      var deleteButton = document.createElement('button');
      deleteButton.appendChild(document.createTextNode('X'));
      // Add an event handler to the remove button
      deleteButton.addEventListener('click', function() {
        // Closure keeps value in scope!
        removeTodo(value);
      });
      // Add the delete button to the list item
      item.appendChild(deleteButton);
      // Add the item to the list
      list.appendChild(item);
    }

    // Render the list by iterating over the array
    function makeList() {
      list.innerHTML = '';
      for (var i = 0; i < todos.length; i++) {
        makeTodo(todos[i]);
      }
    }

    // Add an event handler to the insert button
    insertButton.addEventListener('click', function() {
      // Only add a new item if there's text in the input field
      if (newItem.value.length) {
        // Add the item to the list and re-render
        todos.push(newItem.value);
        makeList();
        // Reset the input value for next time
        newItem.value = '';
      }
    });

    // Initial render
    makeList();
    </script>
  </body>
</html>
